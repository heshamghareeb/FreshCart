"use strict";(self.webpackChunkFresh_Cart=self.webpackChunkFresh_Cart||[]).push([[99],{4768:(x,f,i)=>{i.d(f,{e:()=>h});var g=i(8784),r=i(5619);const __baseUrlAuth="https://ecommerce.routemisr.com/api/v1/auth";var t=i(9212),d=i(1474),u=i(101);let h=(()=>{class p{constructor(n,c){this._HttpClient=n,this._Router=c,this.userData=new r.X(null),this.saveUser()}saveUser(){const n=localStorage.getItem("_token");if(n)try{const c=(0,g.o)(n);c.name&&this.userData.next(c)}catch(c){c.message.includes("Invalid token")&&(localStorage.removeItem("_token"),this._Router.navigate(["/login"]))}}setRegister(n){return this._HttpClient.post(__baseUrlAuth+"/signup",n)}setLogin(n){return this._HttpClient.post(__baseUrlAuth+"/signin",n)}setForgotPassword(n){return this._HttpClient.post(__baseUrlAuth+"/forgotPasswords",n)}setVerifyResetCode(n){return this._HttpClient.post(__baseUrlAuth+"/verifyResetCode",n)}resetPassword(n){return this._HttpClient.put(__baseUrlAuth+"/resetPassword",n)}setChangePassword(n){return this._HttpClient.put("https://ecommerce.routemisr.com/api/v1/users/changeMyPassword",n)}static#t=this.\u0275fac=function(c){return new(c||p)(t.LFG(d.eN),t.LFG(u.F0))};static#e=this.\u0275prov=t.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},8099:(x,f,i)=>{i.r(f),i.d(f,{ForgotpasswordComponent:()=>D});var g=i(6814),r=i(6223),_=i(2618),t=i(9212),d=i(4768),u=i(101);const h=["form1"],p=["form2"],w=["form3"];function n(e,s){1&e&&(t.TgZ(0,"p",13),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Email is required")," "))}function c(e,s){1&e&&(t.TgZ(0,"p",13),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Email Invalid Format")," "))}function C(e,s){if(1&e&&(t.ynx(0),t.YNc(1,n,3,3,"p",12)(2,c,3,3,"p",12),t.BQk()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.f.email.getError("required")),t.xp6(1),t.Q6J("ngIf",o.f.email.getError("email"))}}function Z(e,s){if(1&e&&(t.TgZ(0,"button",14),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const o=t.oxw(2);t.Q6J("disabled",o.forgotForm.invalid),t.xp6(1),t.hij(" ",t.lcZ(2,2,"Next")," ")}}function A(e,s){1&e&&(t.TgZ(0,"button",15)(1,"span"),t._UZ(2,"i",16),t.qZA()())}function v(e,s){if(1&e&&(t.TgZ(0,"p",17),t._uU(1),t.qZA()),2&e){const o=t.oxw(2);t.xp6(1),t.hij(" ",o.errMsg," ")}}function b(e,s){if(1&e){const o=t.EpF();t.TgZ(0,"form",3,4),t.NdJ("ngSubmit",function(){t.CHM(o);const l=t.oxw();return t.KtG(l.handleForgotPassword())}),t.TgZ(2,"div",5)(3,"label",6),t._uU(4),t.ALo(5,"translate"),t.qZA(),t._UZ(6,"input",7),t.ALo(7,"translate"),t.YNc(8,C,3,2,"ng-container",8),t.qZA(),t.YNc(9,Z,3,4,"button",9)(10,A,3,0,"button",10)(11,v,2,1,"p",11),t.qZA()}if(2&e){const o=t.oxw();t.Q6J("formGroup",o.forgotForm),t.xp6(4),t.hij("",t.lcZ(5,7,"Email"),":"),t.xp6(2),t.MGl("placeholder","",t.lcZ(7,9,"Your Email"),"..."),t.xp6(2),t.Q6J("ngIf",o.f.email.errors&&(o.f.email.touched||o.f.email.value.length>0)),t.xp6(1),t.Q6J("ngIf",!o.isLoading),t.xp6(1),t.Q6J("ngIf",o.isLoading),t.xp6(1),t.Q6J("ngIf",o.errMsg)}}function T(e,s){1&e&&(t.TgZ(0,"p",13),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"resetCode is required")," "))}function F(e,s){1&e&&(t.TgZ(0,"p",13),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"must be at 6 chars")," "))}function I(e,s){if(1&e&&(t.ynx(0),t.YNc(1,T,3,3,"p",12)(2,F,3,3,"p",12),t.BQk()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.r.resetCode.getError("required")),t.xp6(1),t.Q6J("ngIf",o.r.resetCode.getError("pattern"))}}function U(e,s){if(1&e&&(t.TgZ(0,"button",14),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const o=t.oxw(2);t.Q6J("disabled",o.verifyCode.invalid),t.xp6(1),t.hij(" ",t.lcZ(2,2,"Confirm")," ")}}function P(e,s){1&e&&(t.TgZ(0,"button",15)(1,"span"),t._UZ(2,"i",16),t.qZA()())}function L(e,s){if(1&e&&(t.TgZ(0,"p",17),t._uU(1),t.qZA()),2&e){const o=t.oxw(2);t.xp6(1),t.hij(" ",o.errMsg," ")}}function M(e,s){if(1&e){const o=t.EpF();t.TgZ(0,"form",3,18),t.NdJ("ngSubmit",function(){t.CHM(o);const l=t.oxw();return t.KtG(l.handleVerifyResetCode())}),t.TgZ(2,"div",5)(3,"label",19),t._uU(4),t.ALo(5,"translate"),t.qZA(),t._UZ(6,"input",20),t.ALo(7,"translate"),t.YNc(8,I,3,2,"ng-container",8),t.qZA(),t.YNc(9,U,3,4,"button",9)(10,P,3,0,"button",10)(11,L,2,1,"p",11),t.qZA()}if(2&e){const o=t.oxw();t.Q6J("formGroup",o.verifyCode),t.xp6(4),t.hij("",t.lcZ(5,7,"Reset Code"),":"),t.xp6(2),t.MGl("placeholder","",t.lcZ(7,9,"Your Reset Code"),"..."),t.xp6(2),t.Q6J("ngIf",o.r.resetCode.errors&&(o.r.resetCode.touched||o.r.resetCode.value.length>0)),t.xp6(1),t.Q6J("ngIf",!o.isLoading),t.xp6(1),t.Q6J("ngIf",o.isLoading),t.xp6(1),t.Q6J("ngIf",o.errMsg)}}function E(e,s){1&e&&(t.TgZ(0,"p",13),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Email is required")," "))}function Q(e,s){1&e&&(t.TgZ(0,"p",13),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Email Invalid Format")," "))}function J(e,s){if(1&e&&(t.ynx(0),t.YNc(1,E,3,3,"p",12)(2,Q,3,3,"p",12),t.BQk()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.c.email.getError("required")),t.xp6(1),t.Q6J("ngIf",o.c.email.getError("email"))}}function q(e,s){1&e&&(t.TgZ(0,"p",25),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"New Password Is Required")," "))}function y(e,s){1&e&&(t.TgZ(0,"p",25),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Must be at least 6 chars")," "))}function N(e,s){if(1&e&&(t.ynx(0),t.YNc(1,q,3,3,"p",24)(2,y,3,3,"p",24),t.BQk()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.c.newPassword.getError("required")),t.xp6(1),t.Q6J("ngIf",o.c.newPassword.getError("pattern"))}}function R(e,s){if(1&e&&(t.TgZ(0,"button",14),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const o=t.oxw(2);t.Q6J("disabled",o.resetPassword.invalid),t.xp6(1),t.hij(" ",t.lcZ(2,2,"Done")," ")}}function j(e,s){1&e&&(t.TgZ(0,"button",15)(1,"span"),t._UZ(2,"i",16),t.qZA()())}function G(e,s){if(1&e&&(t.TgZ(0,"p",17),t._uU(1),t.qZA()),2&e){const o=t.oxw(2);t.xp6(1),t.hij(" ",o.errMsg," ")}}function Y(e,s){if(1&e){const o=t.EpF();t.TgZ(0,"form",3,21),t.NdJ("ngSubmit",function(){t.CHM(o);const l=t.oxw();return t.KtG(l.handleResetPassword())}),t.TgZ(2,"div",5)(3,"label",6),t._uU(4),t.ALo(5,"translate"),t.qZA(),t._UZ(6,"input",7),t.ALo(7,"translate"),t.YNc(8,J,3,2,"ng-container",8),t.qZA(),t.TgZ(9,"div",5)(10,"label",22),t._uU(11),t.ALo(12,"translate"),t.qZA(),t._UZ(13,"input",23),t.ALo(14,"translate"),t.YNc(15,N,3,2,"ng-container",8),t.qZA(),t.YNc(16,R,3,4,"button",9)(17,j,3,0,"button",10)(18,G,2,1,"p",11),t.qZA()}if(2&e){const o=t.oxw();t.Q6J("formGroup",o.resetPassword),t.xp6(4),t.hij("",t.lcZ(5,10,"Email"),":"),t.xp6(2),t.MGl("placeholder","",t.lcZ(7,12,"Your Email"),"..."),t.xp6(2),t.Q6J("ngIf",o.c.email.errors&&(o.c.email.touched||o.c.email.value.length>0)),t.xp6(3),t.hij("",t.lcZ(12,14,"New Password"),":"),t.xp6(2),t.MGl("placeholder","",t.lcZ(14,16,"New Password"),"..."),t.xp6(2),t.Q6J("ngIf",o.c.newPassword.errors&&(o.c.newPassword.value.length||o.c.newPassword.touched)),t.xp6(1),t.Q6J("ngIf",!o.isLoading),t.xp6(1),t.Q6J("ngIf",o.isLoading),t.xp6(1),t.Q6J("ngIf",o.errMsg)}}let D=(()=>{class e{constructor(o,a,l){this._AuthService=o,this._Renderer2=a,this._Router=l,this.first=!0,this.seconde=!1,this.done=!1,this.isLoading=!1,this.errMsg="",this.email=""}ngOnInit(){this.forgotForm=new r.cw({email:new r.NI("",[r.kI.required,r.kI.email])}),this.verifyCode=new r.cw({resetCode:new r.NI("",[r.kI.required,r.kI.pattern(/^\d{6}$/)])}),this.resetPassword=new r.cw({email:new r.NI("",[r.kI.required,r.kI.email]),newPassword:new r.NI("",[r.kI.required,r.kI.pattern(/^\w{6,}$/)])})}get f(){return this.forgotForm.controls}get r(){return this.verifyCode.controls}get c(){return this.resetPassword.controls}handleForgotPassword(){this.isLoading=!0,this.forgotForm.valid&&this._AuthService.setForgotPassword(this.forgotForm.value).subscribe({next:o=>{"success"===o.statusMsg&&(this.errMsg=o.message,this.isLoading=!1,this.forgotForm.disable(),this.email=this.forgotForm.get("email")?.value,this.first=!1,this.seconde=!0)},error:o=>{this.errMsg=o.error.message,this.isLoading=!1}})}handleVerifyResetCode(){this.isLoading=!0,this.verifyCode.valid&&this._AuthService.setVerifyResetCode(this.verifyCode.value).subscribe({next:o=>{"Success"===o.status&&(this.errMsg=o.status,this.isLoading=!1,this.verifyCode.disable(),this.seconde=!1,this.done=!0,this.resetPassword.get("email")?.setValue(this.email),this.resetPassword.get("email")?.disable())},error:o=>{this.errMsg=o.error.message,this.isLoading=!1}})}handleResetPassword(){if(this.isLoading=!0,this.resetPassword.valid){const o={email:this.email,newPassword:this.resetPassword.get("newPassword")?.value};this._AuthService.resetPassword(o).subscribe({next:a=>{a?.token&&(this.errMsg=a.message,localStorage.setItem("_token",a?.token),this._AuthService.saveUser(),this.isLoading=!1,this.resetPassword.disable(),setTimeout(()=>{this._Router.navigate(["/home"])},1e3))},error:a=>{this.errMsg=a.error.message,this.isLoading=!1}})}}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(d.e),t.Y36(t.Qsj),t.Y36(u.F0))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-forgotpassword"]],viewQuery:function(a,l){if(1&a&&(t.Gf(h,5),t.Gf(p,5),t.Gf(w,5)),2&a){let m;t.iGM(m=t.CRH())&&(l.form1=m.first),t.iGM(m=t.CRH())&&(l.form2=m.first),t.iGM(m=t.CRH())&&(l.form3=m.first)}},standalone:!0,features:[t.jDz],decls:7,vars:6,consts:[[1,"bg-main-light","rounded","p-3","shadow","w-50","mx-auto"],[1,"text-center","h3"],["class","vstack gap-3",3,"formGroup","ngSubmit",4,"ngIf"],[1,"vstack","gap-3",3,"formGroup","ngSubmit"],["form1",""],[1,"form-item"],["for","email"],["type","email","formControlName","email",1,"form-control",3,"placeholder"],[4,"ngIf"],["class","main-btn",3,"disabled",4,"ngIf"],["type","button","disabled","","class","main-btn ms-auto",4,"ngIf"],["class","alert alert-danger text-center w-50 mx-auto mb-0 p-1 mt-3",4,"ngIf"],["class","alert alert-danger w-50 p-1 small",4,"ngIf"],[1,"alert","alert-danger","w-50","p-1","small"],[1,"main-btn",3,"disabled"],["type","button","disabled","",1,"main-btn","ms-auto"],[1,"fas","fa-spinner","fa-spin"],[1,"alert","alert-danger","text-center","w-50","mx-auto","mb-0","p-1","mt-3"],["form2",""],["for","resetCode"],["type","text","formControlName","resetCode",1,"form-control",3,"placeholder"],["form3",""],["for","newPassword"],["type","password","formControlName","newPassword",1,"form-control",3,"placeholder"],["class","alert alert-danger w-50 mx-auto p-1 mb-0",4,"ngIf"],[1,"alert","alert-danger","w-50","mx-auto","p-1","mb-0"]],template:function(a,l){1&a&&(t.TgZ(0,"section",0)(1,"h1",1),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,b,12,11,"form",2)(5,M,12,11,"form",2)(6,Y,19,18,"form",2),t.qZA()),2&a&&(t.xp6(2),t.Oqu(t.lcZ(3,4,"Forgot Password")),t.xp6(2),t.Q6J("ngIf",l.first),t.xp6(1),t.Q6J("ngIf",l.seconde),t.xp6(1),t.Q6J("ngIf",l.done))},dependencies:[g.ez,g.O5,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,_.aw,_.X$]})}return e})()}}]);