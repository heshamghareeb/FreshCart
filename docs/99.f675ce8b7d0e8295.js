"use strict";(self.webpackChunkFresh_Cart=self.webpackChunkFresh_Cart||[]).push([[99],{4768:(w,g,_)=>{_.d(g,{e:()=>h});var l=_(8784),r=_(5619);const t_baseUrlAuth="https://ecommerce.routemisr.com/api/v1/auth";var p=_(9212),d=_(1474),u=_(101);let h=(()=>{class c{constructor(n,m){this._HttpClient=n,this._Router=m,this.userData=new r.X(null),this.saveUser()}saveUser(){const n=localStorage.getItem("_token");if(n)try{const m=(0,l.o)(n);m.name&&this.userData.next(m)}catch(m){m.message.includes("Invalid token")&&(localStorage.removeItem("_token"),this._Router.navigate(["/login"]))}}setRegister(n){return this._HttpClient.post(t_baseUrlAuth+"/signup",n)}setLogin(n){return this._HttpClient.post(t_baseUrlAuth+"/signin",n)}setForgotPassword(n){return this._HttpClient.post(t_baseUrlAuth+"/forgotPasswords",n)}setVerifyResetCode(n){return this._HttpClient.post(t_baseUrlAuth+"/verifyResetCode",n)}resetPassword(n){return this._HttpClient.put(t_baseUrlAuth+"/resetPassword",n)}setChangePassword(n){return this._HttpClient.put("https://ecommerce.routemisr.com/api/v1/users/changeMyPassword",n)}static#t=this.\u0275fac=function(m){return new(m||c)(p.LFG(d.eN),p.LFG(u.F0))};static#e=this.\u0275prov=p.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},8099:(w,g,_)=>{_.r(g),_.d(g,{ForgotpasswordComponent:()=>D});var l=_(6814),r=_(6223),t=_(9212),p=_(4768),d=_(101);const u=["form1"],h=["form2"],c=["form3"];function x(o,s){1&o&&(t.TgZ(0,"p",13),t._uU(1," Email is required "),t.qZA())}function n(o,s){1&o&&(t.TgZ(0,"p",13),t._uU(1," Email InValid Format "),t.qZA())}function m(o,s){if(1&o&&(t.ynx(0),t.YNc(1,x,2,0,"p",12)(2,n,2,0,"p",12),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.f.email.getError("required")),t.xp6(1),t.Q6J("ngIf",e.f.email.getError("email"))}}function C(o,s){if(1&o&&(t.TgZ(0,"button",14),t._uU(1," Next "),t.qZA()),2&o){const e=t.oxw(2);t.Q6J("disabled",e.forgotForm.invalid)}}function b(o,s){1&o&&(t.TgZ(0,"button",15)(1,"span"),t._UZ(2,"i",16),t.qZA()())}function Z(o,s){if(1&o&&(t.TgZ(0,"p",17),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.errMsg," ")}}function v(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"form",3,4),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleForgotPassword())}),t.TgZ(2,"div",5)(3,"label",6),t._uU(4,"Email:"),t.qZA(),t._UZ(5,"input",7),t.YNc(6,m,3,2,"ng-container",8),t.qZA(),t.YNc(7,C,2,1,"button",9)(8,b,3,0,"button",10)(9,Z,2,1,"p",11),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.forgotForm),t.xp6(6),t.Q6J("ngIf",e.f.email.errors&&(e.f.email.touched||e.f.email.value.length>0)),t.xp6(1),t.Q6J("ngIf",!e.isLoading),t.xp6(1),t.Q6J("ngIf",e.isLoading),t.xp6(1),t.Q6J("ngIf",e.errMsg)}}function T(o,s){1&o&&(t.TgZ(0,"p",13),t._uU(1," resetCode is required "),t.qZA())}function F(o,s){1&o&&(t.TgZ(0,"p",13),t._uU(1," must be at 6 chars "),t.qZA())}function I(o,s){if(1&o&&(t.ynx(0),t.YNc(1,T,2,0,"p",12)(2,F,2,0,"p",12),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.r.resetCode.getError("required")),t.xp6(1),t.Q6J("ngIf",e.r.resetCode.getError("pattern"))}}function U(o,s){if(1&o&&(t.TgZ(0,"button",14),t._uU(1," Confirm "),t.qZA()),2&o){const e=t.oxw(2);t.Q6J("disabled",e.verifyCode.invalid)}}function A(o,s){1&o&&(t.TgZ(0,"button",15)(1,"span"),t._UZ(2,"i",16),t.qZA()())}function P(o,s){if(1&o&&(t.TgZ(0,"p",17),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.errMsg," ")}}function Q(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"form",3,18),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleVerifyResetCode())}),t.TgZ(2,"div",5)(3,"label",19),t._uU(4,"Reset Code:"),t.qZA(),t._UZ(5,"input",20),t.YNc(6,I,3,2,"ng-container",8),t.qZA(),t.YNc(7,U,2,1,"button",9)(8,A,3,0,"button",10)(9,P,2,1,"p",11),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.verifyCode),t.xp6(6),t.Q6J("ngIf",e.r.resetCode.errors&&(e.r.resetCode.touched||e.r.resetCode.value.length>0)),t.xp6(1),t.Q6J("ngIf",!e.isLoading),t.xp6(1),t.Q6J("ngIf",e.isLoading),t.xp6(1),t.Q6J("ngIf",e.errMsg)}}function J(o,s){1&o&&(t.TgZ(0,"p",13),t._uU(1," Email is required "),t.qZA())}function E(o,s){1&o&&(t.TgZ(0,"p",13),t._uU(1," Email InValid Format "),t.qZA())}function M(o,s){if(1&o&&(t.ynx(0),t.YNc(1,J,2,0,"p",12)(2,E,2,0,"p",12),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.c.email.getError("required")),t.xp6(1),t.Q6J("ngIf",e.c.email.getError("email"))}}function q(o,s){1&o&&(t.TgZ(0,"p",25),t._uU(1," New Password Is Required "),t.qZA())}function y(o,s){1&o&&(t.TgZ(0,"p",25),t._uU(1," Must be at least 6 chars "),t.qZA())}function L(o,s){if(1&o&&(t.ynx(0),t.YNc(1,q,2,0,"p",24)(2,y,2,0,"p",24),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.c.newPassword.getError("required")),t.xp6(1),t.Q6J("ngIf",e.c.newPassword.getError("pattern"))}}function N(o,s){if(1&o&&(t.TgZ(0,"button",14),t._uU(1," Done "),t.qZA()),2&o){const e=t.oxw(2);t.Q6J("disabled",e.resetPassword.invalid)}}function R(o,s){1&o&&(t.TgZ(0,"button",15)(1,"span"),t._UZ(2,"i",16),t.qZA()())}function Y(o,s){if(1&o&&(t.TgZ(0,"p",17),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.errMsg," ")}}function S(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"form",3,21),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.handleResetPassword())}),t.TgZ(2,"div",5)(3,"label",6),t._uU(4,"Email:"),t.qZA(),t._UZ(5,"input",7),t.YNc(6,M,3,2,"ng-container",8),t.qZA(),t.TgZ(7,"div",5)(8,"label",22),t._uU(9,"newPassword:"),t.qZA(),t._UZ(10,"input",23),t.YNc(11,L,3,2,"ng-container",8),t.qZA(),t.YNc(12,N,2,1,"button",9)(13,R,3,0,"button",10)(14,Y,2,1,"p",11),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.resetPassword),t.xp6(6),t.Q6J("ngIf",e.c.email.errors&&(e.c.email.touched||e.c.email.value.length>0)),t.xp6(5),t.Q6J("ngIf",e.c.newPassword.errors&&(e.c.newPassword.value.length||e.c.newPassword.touched)),t.xp6(1),t.Q6J("ngIf",!e.isLoading),t.xp6(1),t.Q6J("ngIf",e.isLoading),t.xp6(1),t.Q6J("ngIf",e.errMsg)}}let D=(()=>{class o{constructor(e,a,i){this._AuthService=e,this._Renderer2=a,this._Router=i,this.first=!0,this.seconde=!1,this.done=!1,this.isLoading=!1,this.errMsg="",this.email=""}ngOnInit(){this.forgotForm=new r.cw({email:new r.NI("",[r.kI.required,r.kI.email])}),this.verifyCode=new r.cw({resetCode:new r.NI("",[r.kI.required,r.kI.pattern(/^\d{6}$/)])}),this.resetPassword=new r.cw({email:new r.NI("",[r.kI.required,r.kI.email]),newPassword:new r.NI("",[r.kI.required,r.kI.pattern(/^\w{6,}$/)])})}get f(){return this.forgotForm.controls}get r(){return this.verifyCode.controls}get c(){return this.resetPassword.controls}handleForgotPassword(){this.isLoading=!0,this.forgotForm.valid&&this._AuthService.setForgotPassword(this.forgotForm.value).subscribe({next:e=>{"success"===e.statusMsg&&(this.errMsg=e.message,this.isLoading=!1,this.forgotForm.disable(),this.email=this.forgotForm.get("email")?.value,this.first=!1,this.seconde=!0)},error:e=>{this.errMsg=e.error.message,this.isLoading=!1}})}handleVerifyResetCode(){this.isLoading=!0,this.verifyCode.valid&&this._AuthService.setVerifyResetCode(this.verifyCode.value).subscribe({next:e=>{"Success"===e.status&&(this.errMsg=e.status,this.isLoading=!1,this.verifyCode.disable(),this.seconde=!1,this.done=!0,this.resetPassword.get("email")?.setValue(this.email),this.resetPassword.get("email")?.disable())},error:e=>{this.errMsg=e.error.message,this.isLoading=!1}})}handleResetPassword(){if(this.isLoading=!0,this.resetPassword.valid){const e={email:this.email,newPassword:this.resetPassword.get("newPassword")?.value};this._AuthService.resetPassword(e).subscribe({next:a=>{a?.token&&(this.errMsg=a.message,localStorage.setItem("_token",a?.token),this._AuthService.saveUser(),this.isLoading=!1,this.resetPassword.disable(),setTimeout(()=>{this._Router.navigate(["/home"])},1e3))},error:a=>{this.errMsg=a.error.message,this.isLoading=!1}})}}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(p.e),t.Y36(t.Qsj),t.Y36(d.F0))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-forgotpassword"]],viewQuery:function(a,i){if(1&a&&(t.Gf(u,5),t.Gf(h,5),t.Gf(c,5)),2&a){let f;t.iGM(f=t.CRH())&&(i.form1=f.first),t.iGM(f=t.CRH())&&(i.form2=f.first),t.iGM(f=t.CRH())&&(i.form3=f.first)}},standalone:!0,features:[t.jDz],decls:6,vars:3,consts:[[1,"bg-main-light","rounded","p-3","shadow","w-50","mx-auto"],[1,"text-center","h3"],["class","vstack gap-3",3,"formGroup","ngSubmit",4,"ngIf"],[1,"vstack","gap-3",3,"formGroup","ngSubmit"],["form1",""],[1,"form-item"],["for","email"],["type","email","formControlName","email","placeholder","Your Email...",1,"form-control"],[4,"ngIf"],["class","main-btn",3,"disabled",4,"ngIf"],["type","button","disabled","","class","main-btn ms-auto",4,"ngIf"],["class","alert alert-danger text-center w-50 mx-auto mb-0 p-1 mt-3",4,"ngIf"],["class","alert alert-danger w-50 p-1 small",4,"ngIf"],[1,"alert","alert-danger","w-50","p-1","small"],[1,"main-btn",3,"disabled"],["type","button","disabled","",1,"main-btn","ms-auto"],[1,"fas","fa-spinner","fa-spin"],[1,"alert","alert-danger","text-center","w-50","mx-auto","mb-0","p-1","mt-3"],["form2",""],["for","resetCode"],["type","text","formControlName","resetCode","placeholder","Your Reset Code...",1,"form-control"],["form3",""],["for","newPassword"],["type","password","formControlName","newPassword","placeholder","Your newPassword...",1,"form-control"],["class","alert alert-danger w-50 mx-auto p-1 mb-0",4,"ngIf"],[1,"alert","alert-danger","w-50","mx-auto","p-1","mb-0"]],template:function(a,i){1&a&&(t.TgZ(0,"section",0)(1,"h1",1),t._uU(2,"Forgot Password"),t.qZA(),t.YNc(3,v,10,5,"form",2)(4,Q,10,5,"form",2)(5,S,15,6,"form",2),t.qZA()),2&a&&(t.xp6(3),t.Q6J("ngIf",i.first),t.xp6(1),t.Q6J("ngIf",i.seconde),t.xp6(1),t.Q6J("ngIf",i.done))},dependencies:[l.ez,l.O5,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}return o})()}}]);